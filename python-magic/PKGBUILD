pkgname=python-magic
pkgver=5.14
pkgrel=1
pkgdesc="Python bindings to allow you to access the libmagic api"
arch=('i686' 'x86_64')
url="http://darwinsys.com/file/"
license=('custom')
depends=('file' 'python2' 'python')
source=(ftp://ftp.astron.com/pub/file/file-$pkgver.tar.gz)
md5sums=('c26625f1d6773ad4bc5a87c0e315632c')

build() {
    cd $srcdir/file-$pkgver/python
    sed -i 's#/usr/bin/python#/usr/bin/python2#' ../magic/Magdir/python

    python2 setup.py build
    mkdir -p $pkgdir/usr/lib/python2.7/lib-dynload
    cp build/lib/magic.py $pkgdir/usr/lib/python2.7/lib-dynload/

    sed -i 's#/usr/bin/python2#/usr/bin/python#' ../magic/Magdir/python

    python setup.py build
    mkdir -p $pkgdir/usr/lib/python3.3/lib-dynload
    cp build/lib/magic.py $pkgdir/usr/lib/python3.3/lib-dynload/

    install -D -m644 $srcdir/file-$pkgver/COPYING $pkgdir/usr/share/licenses/$pkgname/COPYING
}
